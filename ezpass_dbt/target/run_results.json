{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.0b3", "generated_at": "2025-11-05T05:52:10.170064Z", "invocation_id": "279b7d61-5c2d-440c-985b-4c7e7df18a65", "invocation_started_at": "2025-11-05T05:52:02.420279Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-05T05:52:09.871491Z", "completed_at": "2025-11-05T05:52:09.892957Z"}, {"name": "execute", "started_at": "2025-11-05T05:52:09.893489Z", "completed_at": "2025-11-05T05:52:09.893500Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08729743957519531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ezpass_dbt.silver", "compiled": true, "compiled_code": "\n\nwith __dbt__cte___silver__cleaning as (\n\n\nWITH source AS (\n    SELECT * FROM `njc-ezpass`.`ezpass_data`.`bronze`\n),\n\ncleaned AS (\n    SELECT\n        -- Convert dates (STRING YYYY-MM-DD \u2192 DATE)\n        SAFE.PARSE_DATE('%Y-%m-%d', transaction_date) as transaction_date,\n        SAFE.PARSE_DATE('%Y-%m-%d', posting_date) as posting_date,\n        \n        -- Convert timestamps (STRING YYYY-MM-DD HH:MM:SS \u2192 TIMESTAMP)\n        SAFE.PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', entry_time) as entry_time,\n        SAFE.PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', exit_time) as exit_time,\n        \n        -- Clean and standardize text fields (replace '-' with NULL)\n        NULLIF(UPPER(TRIM(tag_plate_number)), '-') as tag_plate_number,\n        NULLIF(UPPER(TRIM(agency)), '-') as agency,\n        NULLIF(TRIM(description), '-') as description,\n        NULLIF(UPPER(TRIM(entry_plaza)), '-') as entry_plaza,\n        NULLIF(TRIM(entry_lane), '-') as entry_lane,\n        NULLIF(UPPER(TRIM(exit_plaza)), '-') as exit_plaza,\n        NULLIF(TRIM(exit_lane), '-') as exit_lane,\n        NULLIF(TRIM(vehicle_type_code), '-') as vehicle_type_code,\n        NULLIF(TRIM(plan_rate), '-') as plan_rate,\n        NULLIF(TRIM(prepaid), '-') as prepaid,\n        NULLIF(TRIM(fare_type), '-') as fare_type,\n        \n        -- Convert numeric fields (STRING \u2192 FLOAT64)\n        SAFE_CAST(amount AS FLOAT64) as amount,\n        SAFE_CAST(balance AS FLOAT64) as balance,\n        \n        -- Keep metadata\n        SAFE.PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', loaded_at) as loaded_at,\n        source_file\n        \n    FROM source\n    WHERE transaction_date IS NOT NULL  -- Filter out bad records\n)\n\nSELECT * FROM cleaned\n),  __dbt__cte___silver__enrichment as (\n\n\nWITH cleaned AS (\n    SELECT * FROM __dbt__cte___silver__cleaning\n),\n\nenriched AS (\n    SELECT\n        *,\n        \n        -- Agency name enrichment\n        CASE agency\n            WHEN 'GSP' THEN 'Garden State Parkway'\n            WHEN 'NJTP' THEN 'New Jersey Turnpike'\n            WHEN 'SJ' THEN 'South Jersey Transportation Authority'\n            WHEN 'PTC' THEN 'Pennsylvania Turnpike Commission'\n            WHEN 'DRJTBC' THEN 'Delaware River Joint Toll Bridge Commission'\n            WHEN 'DRPA' THEN 'Delaware River Port Authority'\n            WHEN 'PANYNJ' THEN 'Port Authority of NY & NJ'\n            WHEN 'BCBC' THEN 'Burlington County Bridge Commission'\n            WHEN 'NJ E-ZPASS' THEN 'NJ E-ZPass (back office)'\n            WHEN 'CBDTP' THEN 'Central Business District Tolling Program'\n            WHEN 'DELDOT' THEN 'Delaware Department of Transportation'\n            WHEN 'DRBA' THEN 'Delaware River & Bay Authority'\n            WHEN 'ILTOLL' THEN 'Illinois Tollway Authority'\n            WHEN 'ITRCC' THEN 'Indiana Toll Road Concession Company'\n            WHEN 'MASSDOT' THEN 'Massachusetts Department of Transportation'\n            WHEN 'MDTA' THEN 'Maryland Transportation Authority'\n            WHEN 'META' THEN 'Maine Turnpike Authority'\n            WHEN 'MTAB&T' THEN 'MTA Bridges and Tunnels'\n            WHEN 'NHDOT' THEN 'New Hampshire Department of Transportation'\n            WHEN 'NYSBA' THEN 'New York State Bridge Authority'\n            WHEN 'NYSTA' THEN 'New York State Bridge Authority'\n            WHEN 'OTIC' THEN 'Ohio Turnpike and Infrastructure Commission'\n            WHEN 'VDOT' THEN 'Virginia Department of Transportation'\n            ELSE NULL  -- Unknown values become NULL\n        END as agency_name,\n\n        -- State's abbreviation name\n        CASE agency\n            WHEN 'GSP' THEN 'NJ'\n            WHEN 'NJTP' THEN 'NJ'\n            WHEN 'SJ' THEN 'NJ'\n            WHEN 'PTC' THEN 'PA'\n            WHEN 'DRJTBC' THEN 'PA'\n            WHEN 'DRPA' THEN 'PA'\n            WHEN 'PANYNJ' THEN 'NY'\n            WHEN 'BCBC' THEN 'PA'\n            WHEN 'NJ E-ZPASS' THEN 'NJ'\n            WHEN 'CBDTP' THEN 'NY'\n            WHEN 'DELDOT' THEN 'DE'\n            WHEN 'DRBA' THEN 'DE'\n            WHEN 'ILTOLL' THEN 'IL'\n            WHEN 'ITRCC' THEN 'IN'\n            WHEN 'MASSDOT' THEN 'MA'\n            WHEN 'MDTA' THEN 'MD'\n            WHEN 'META' THEN 'ME'\n            WHEN 'MTAB&T' THEN 'NY'\n            WHEN 'NHDOT' THEN 'NH'\n            WHEN 'NYSBA' THEN 'NY'\n            WHEN 'NYSTA' THEN 'NY'\n            WHEN 'OTIC' THEN 'OH'\n            WHEN 'VDOT' THEN 'VA'\n            ELSE NULL  -- Unknown values become NULL\n        END as state_name,\n\n        -- Entry plaza name enrichment\n        CASE entry_plaza\n            -- GSP (Garden State Parkway)\n            WHEN 'PVK' THEN 'Pascack Valley'\n            WHEN 'PRS' THEN 'Paramus South'\n            WHEN 'PRN' THEN 'Paramus North'\n            WHEN 'BER' THEN 'Bergen'\n            WHEN 'SAB' THEN 'Saddle Brook'\n            WHEN 'CLS' THEN 'Clifton South'\n            WHEN 'CLN' THEN 'Clifton North'\n            WHEN 'PSS' THEN 'Passaic South'\n            WHEN 'PSN' THEN 'Passaic North'\n            WHEN 'WAS' THEN 'Watchung South'\n            WHEN 'WAN' THEN 'Watchung North'\n            WHEN 'ESS' THEN 'Essex'\n            WHEN 'BLS' THEN 'Bloomfield South'\n            WHEN 'BLN' THEN 'Bloomfield North'\n            WHEN 'EOR' THEN 'East Orange'\n            WHEN 'IRS' THEN 'Irvington South'\n            WHEN 'IRN' THEN 'Irvington North'\n            WHEN 'UNR' THEN 'Union Ramp'\n            WHEN 'UNI' THEN 'Union'\n            WHEN 'RAS' THEN 'Raritan South'\n            WHEN 'MAT' THEN 'Matawan'\n            WHEN 'KEY' THEN 'Keyport'\n            WHEN 'HOS' THEN 'Holmdel South'\n            WHEN 'HON' THEN 'Holmdel North'\n            WHEN 'RBS' THEN 'Red Bank South'\n            WHEN 'RBN' THEN 'Red Bank North'\n            WHEN 'EAT' THEN 'Eatontown'\n            WHEN 'ASP' THEN 'Asbury Park'\n            WHEN 'BES' THEN 'Belmar South'\n            WHEN 'BEN' THEN 'Belmar North'\n            WHEN 'BRS' THEN 'Brick South'\n            WHEN 'BRN' THEN 'Brick North'\n            WHEN 'LWS' THEN 'Lakewood South'\n            WHEN 'LWN' THEN 'Lakewood North'\n            WHEN 'TRV' THEN 'Toms River'\n            WHEN 'LRS' THEN 'Lacey Rd South'\n            WHEN 'LRN' THEN 'Lacey Rd North'\n            WHEN 'BAR' THEN 'Barnegat'\n            WHEN 'BKS' THEN 'Berkeley Ramp South'\n            WHEN 'BKN' THEN 'Berkeley Ramp North'\n            WHEN 'NGR' THEN 'New Gretna'\n            WHEN 'WRS' THEN 'Waretown South'\n            WHEN 'WRN' THEN 'Waretown North'\n            WHEN 'SPT' THEN 'Somers Point'\n            WHEN 'GEG' THEN 'Great Egg'\n            WHEN 'CMY' THEN 'Cape May'\n            WHEN 'WWS' THEN 'Wildwood South'\n            WHEN 'WWN' THEN 'Wildwood North'\n            WHEN 'SAY' THEN 'Sayreville'\n            -- NJTP (Turnpike)\n            WHEN '1' THEN 'Delaware Memorial Bridge'\n            WHEN '2' THEN 'Swedesboro/Chester'\n            WHEN '3' THEN 'Woodbury/S. Camden/NJ Aquarium'\n            WHEN '4' THEN 'Camden/Philadelphia/NJ Aquarium'\n            WHEN '5' THEN 'Burlington/Mt. Holly'\n            WHEN '6' THEN 'PA Turnpike/Florence'\n            WHEN '6A' THEN 'PA Turnpike/Florence'\n            WHEN '6B' THEN 'Rte. 130 Credit Ramp'\n            WHEN '7' THEN 'Bordentown/Trenton'\n            WHEN '7A' THEN 'I-195/Trenton/Shore Points'\n            WHEN '8' THEN 'Hightstown/Freehold'\n            WHEN '8A' THEN 'Jamesburg/Cranbury'\n            WHEN '9' THEN 'New Brunswick/Admin Bldg'\n            WHEN '10' THEN 'I-287/Metuchen/Edison Twsp'\n            WHEN '11' THEN 'GSP/Woodbridge/The Amboys'\n            WHEN '12' THEN 'Carteret/Rahway'\n            WHEN '13' THEN 'I-278/Eliz/Goethals/Verrazano'\n            WHEN '13A' THEN 'Newark Aprt/Elizabeth Seaport'\n            WHEN '14' THEN 'I-78/Newark Airport'\n            WHEN '14A' THEN 'Bayonne'\n            WHEN '14B' THEN 'Jersey City/Liberty State Park'\n            WHEN '14C' THEN 'Holland Tunnel'\n            WHEN '15E' THEN 'Newark/Jersey City'\n            WHEN '15W' THEN 'I-280/Newark/The Oranges'\n            WHEN '15X' THEN 'Secaucus Transfer Station'\n            WHEN '16E' THEN 'Lincoln Tunnel/NJ 3/Secaucus'\n            WHEN '16W' THEN 'Sprtsplx/NJ 3/Secaucus/Ruthrfrd'\n            WHEN '17' THEN 'Secaucus/US 46'\n            WHEN '18E' THEN 'Lincoln Tunnel/NJ 3/Secaucus'\n            WHEN '18W' THEN 'Geo Washington Br/US 46/I-80'\n            WHEN '19W' THEN 'Carlstadt'\n            -- SJ (South Jersey)\n            WHEN 'APL' THEN 'Pleasantville Mainline Barrier'\n            WHEN 'AR9' THEN 'Route 9'\n            WHEN 'APO' THEN 'Pomona'\n            WHEN 'ACY' THEN 'AC Airport'\n            WHEN 'AML' THEN 'Mays Landing'\n            WHEN 'A50' THEN 'Route 50'\n            WHEN 'AEH' THEN 'Egg Harbor Mainline Barrier'\n            WHEN 'AH' THEN 'Hammonton Ramp'\n            WHEN 'AWN' THEN 'Winslow Ramp'\n            WHEN 'AWL' THEN 'Williamstown Ramp'\n            WHEN 'ACK' THEN 'Cross Keys'\n            WHEN 'OCL' THEN 'Ocean City-Longport Bridge'\n            WHEN 'CIB' THEN 'Corsons Inlet Bridge'\n            WHEN 'TIB' THEN 'Townsends Inlet Bridge'\n            WHEN 'GSB' THEN 'Grassy Sound Bridge'\n            WHEN 'MTB' THEN 'Middle Thorofare Bridge'\n            -- DRPA\n            WHEN 'BRB' THEN 'Betsy Ross Br'\n            WHEN 'BFB' THEN 'Ben Franklin Br'\n            WHEN 'WWB' THEN 'Walt Whitman Br'\n            WHEN 'CBB' THEN 'Commodore Barry Br'\n            -- DRBA\n            WHEN 'DMB' THEN 'Delaware Memorial Br'\n            -- BCBC\n            WHEN 'TPB' THEN 'Tacony Palmyra Br'\n            WHEN 'BBB' THEN 'Burlington Bristol Br'\n            -- DRJTBC\n            WHEN 'T-M' THEN 'Trenton-Morrisville Br'\n            WHEN 'NHL' THEN 'New Hope-Lambertville Br'\n            WHEN 'I78' THEN 'I-78 Br'\n            WHEN 'E-P' THEN 'Easton-Phillipsburg Br'\n            WHEN 'P-C' THEN 'Portland-Columbia Br'\n            WHEN 'DWG' THEN 'Delaware Water Gap Br'\n            WHEN 'M-M' THEN 'Milford-Montague Br'\n            WHEN 'O78' THEN 'Interstate 78-ORT'\n            WHEN 'ODW' THEN 'Delaware Water Gap-ORT'\n            WHEN 'OSF' THEN 'Scudder Falls Br'\n            ELSE NULL  -- Unknown values become NULL\n        END as entry_plaza_name,\n        \n        -- Exit plaza name enrichment\n        CASE exit_plaza\n            -- GSP\n            WHEN 'PVK' THEN 'Pascack Valley'\n            WHEN 'PRS' THEN 'Paramus South'\n            WHEN 'PRN' THEN 'Paramus North'\n            WHEN 'BER' THEN 'Bergen'\n            WHEN 'SAB' THEN 'Saddle Brook'\n            WHEN 'CLS' THEN 'Clifton South'\n            WHEN 'CLN' THEN 'Clifton North'\n            WHEN 'PSS' THEN 'Passaic South'\n            WHEN 'PSN' THEN 'Passaic North'\n            WHEN 'WAS' THEN 'Watchung South'\n            WHEN 'WAN' THEN 'Watchung North'\n            WHEN 'ESS' THEN 'Essex'\n            WHEN 'BLS' THEN 'Bloomfield South'\n            WHEN 'BLN' THEN 'Bloomfield North'\n            WHEN 'EOR' THEN 'East Orange'\n            WHEN 'IRS' THEN 'Irvington South'\n            WHEN 'IRN' THEN 'Irvington North'\n            WHEN 'UNR' THEN 'Union Ramp'\n            WHEN 'UNI' THEN 'Union'\n            WHEN 'RAS' THEN 'Raritan South'\n            WHEN 'MAT' THEN 'Matawan'\n            WHEN 'KEY' THEN 'Keyport'\n            WHEN 'HOS' THEN 'Holmdel South'\n            WHEN 'HON' THEN 'Holmdel North'\n            WHEN 'RBS' THEN 'Red Bank South'\n            WHEN 'RBN' THEN 'Red Bank North'\n            WHEN 'EAT' THEN 'Eatontown'\n            WHEN 'ASP' THEN 'Asbury Park'\n            WHEN 'BES' THEN 'Belmar South'\n            WHEN 'BEN' THEN 'Belmar North'\n            WHEN 'BRS' THEN 'Brick South'\n            WHEN 'BRN' THEN 'Brick North'\n            WHEN 'LWS' THEN 'Lakewood South'\n            WHEN 'LWN' THEN 'Lakewood North'\n            WHEN 'TRV' THEN 'Toms River'\n            WHEN 'LRS' THEN 'Lacey Rd South'\n            WHEN 'LRN' THEN 'Lacey Rd North'\n            WHEN 'BAR' THEN 'Barnegat'\n            WHEN 'BKS' THEN 'Berkeley Ramp South'\n            WHEN 'BKN' THEN 'Berkeley Ramp North'\n            WHEN 'NGR' THEN 'New Gretna'\n            WHEN 'WRS' THEN 'Waretown South'\n            WHEN 'WRN' THEN 'Waretown North'\n            WHEN 'SPT' THEN 'Somers Point'\n            WHEN 'GEG' THEN 'Great Egg'\n            WHEN 'CMY' THEN 'Cape May'\n            WHEN 'WWS' THEN 'Wildwood South'\n            WHEN 'WWN' THEN 'Wildwood North'\n            WHEN 'SAY' THEN 'Sayreville'\n            -- NJTP\n            WHEN '1' THEN 'Delaware Memorial Bridge'\n            WHEN '2' THEN 'Swedesboro/Chester'\n            WHEN '3' THEN 'Woodbury/S. Camden/NJ Aquarium'\n            WHEN '4' THEN 'Camden/Philadelphia/NJ Aquarium'\n            WHEN '5' THEN 'Burlington/Mt. Holly'\n            WHEN '6' THEN 'PA Turnpike/Florence'\n            WHEN '6A' THEN 'PA Turnpike/Florence'\n            WHEN '6B' THEN 'Rte. 130 Credit Ramp'\n            WHEN '7' THEN 'Bordentown/Trenton'\n            WHEN '7A' THEN 'I-195/Trenton/Shore Points'\n            WHEN '8' THEN 'Hightstown/Freehold'\n            WHEN '8A' THEN 'Jamesburg/Cranbury'\n            WHEN '9' THEN 'New Brunswick/Admin Bldg'\n            WHEN '10' THEN 'I-287/Metuchen/Edison Twsp'\n            WHEN '11' THEN 'GSP/Woodbridge/The Amboys'\n            WHEN '12' THEN 'Carteret/Rahway'\n            WHEN '13' THEN 'I-278/Eliz/Goethals/Verrazano'\n            WHEN '13A' THEN 'Newark Aprt/Elizabeth Seaport'\n            WHEN '14' THEN 'I-78/Newark Airport'\n            WHEN '14A' THEN 'Bayonne'\n            WHEN '14B' THEN 'Jersey City/Liberty State Park'\n            WHEN '14C' THEN 'Holland Tunnel'\n            WHEN '15E' THEN 'Newark/Jersey City'\n            WHEN '15W' THEN 'I-280/Newark/The Oranges'\n            WHEN '15X' THEN 'Secaucus Transfer Station'\n            WHEN '16E' THEN 'Lincoln Tunnel/NJ 3/Secaucus'\n            WHEN '16W' THEN 'Sprtsplx/NJ 3/Secaucus/Ruthrfrd'\n            WHEN '17' THEN 'Secaucus/US 46'\n            WHEN '18E' THEN 'Lincoln Tunnel/NJ 3/Secaucus'\n            WHEN '18W' THEN 'Geo Washington Br/US 46/I-80'\n            WHEN '19W' THEN 'Carlstadt'\n            -- SJ\n            WHEN 'APL' THEN 'Pleasantville Mainline Barrier'\n            WHEN 'AR9' THEN 'Route 9'\n            WHEN 'APO' THEN 'Pomona'\n            WHEN 'ACY' THEN 'AC Airport'\n            WHEN 'AML' THEN 'Mays Landing'\n            WHEN 'A50' THEN 'Route 50'\n            WHEN 'AEH' THEN 'Egg Harbor Mainline Barrier'\n            WHEN 'AH' THEN 'Hammonton Ramp'\n            WHEN 'AWN' THEN 'Winslow Ramp'\n            WHEN 'AWL' THEN 'Williamstown Ramp'\n            WHEN 'ACK' THEN 'Cross Keys'\n            WHEN 'OCL' THEN 'Ocean City-Longport Bridge'\n            WHEN 'CIB' THEN 'Corsons Inlet Bridge'\n            WHEN 'TIB' THEN 'Townsends Inlet Bridge'\n            WHEN 'GSB' THEN 'Grassy Sound Bridge'\n            WHEN 'MTB' THEN 'Middle Thorofare Bridge'\n            -- DRPA\n            WHEN 'BRB' THEN 'Betsy Ross Br'\n            WHEN 'BFB' THEN 'Ben Franklin Br'\n            WHEN 'WWB' THEN 'Walt Whitman Br'\n            WHEN 'CBB' THEN 'Commodore Barry Br'\n            -- DRBA\n            WHEN 'DMB' THEN 'Delaware Memorial Br'\n            -- BCBC\n            WHEN 'TPB' THEN 'Tacony Palmyra Br'\n            WHEN 'BBB' THEN 'Burlington Bristol Br'\n            -- DRJTBC\n            WHEN 'T-M' THEN 'Trenton-Morrisville Br'\n            WHEN 'NHL' THEN 'New Hope-Lambertville Br'\n            WHEN 'I78' THEN 'I-78 Br'\n            WHEN 'E-P' THEN 'Easton-Phillipsburg Br'\n            WHEN 'P-C' THEN 'Portland-Columbia Br'\n            WHEN 'DWG' THEN 'Delaware Water Gap Br'\n            WHEN 'M-M' THEN 'Milford-Montague Br'\n            WHEN 'O78' THEN 'Interstate 78-ORT'\n            WHEN 'ODW' THEN 'Delaware Water Gap-ORT'\n            WHEN 'OSF' THEN 'Scudder Falls Br'\n            ELSE NULL  -- Unknown values become NULL\n        END as exit_plaza_name\n        \n    FROM cleaned\n)\n\nSELECT * FROM enriched\n),  __dbt__cte___silver__feateng as (\n\n\nWITH enriched AS (\n    SELECT * FROM __dbt__cte___silver__enrichment\n),\n\nnew_features AS (\n    SELECT\n        *,\n        -- Feature engineering\n        -- ============================================\n        -- TIME-BASED FEATURES\n        -- ============================================\n\n        -- Extract datetime components\n        EXTRACT(DAYOFWEEK FROM transaction_date) as transaction_dayofweek,  -- 1=Sun, 7=Sat\n        EXTRACT(DAYOFYEAR FROM transaction_date) as transaction_dayofyear,\n        FORMAT_DATE('%B', transaction_date) as transaction_month,\n        FORMAT_DATE('%A', transaction_date) as transaction_day,\n\n        -- Categorize days\n        CASE \n            WHEN EXTRACT(DAYOFWEEK FROM transaction_date) IN (1, 7) THEN 'Weekend'\n            ELSE 'Weekday'\n        END as is_weekend,\n\n        -- TIME OF DAY FEATURES\n        -- Entry time of day\n        CASE \n            WHEN EXTRACT(HOUR FROM entry_time) BETWEEN 0 AND 5 THEN 'Night'\n            WHEN EXTRACT(HOUR FROM entry_time) BETWEEN 6 AND 8 THEN 'Morning Rush'\n            WHEN EXTRACT(HOUR FROM entry_time) BETWEEN 9 AND 11 THEN 'Morning'\n            WHEN EXTRACT(HOUR FROM entry_time) BETWEEN 12 AND 14 THEN 'Midday'\n            WHEN EXTRACT(HOUR FROM entry_time) BETWEEN 15 AND 18 THEN 'Evening Rush'\n            WHEN EXTRACT(HOUR FROM entry_time) BETWEEN 19 AND 21 THEN 'Evening'\n            ELSE 'Late Night'\n        END as entry_time_of_day,\n\n        -- Exit time of day\n        CASE \n            WHEN EXTRACT(HOUR FROM exit_time) BETWEEN 0 AND 5 THEN 'Night'\n            WHEN EXTRACT(HOUR FROM exit_time) BETWEEN 6 AND 8 THEN 'Morning Rush'\n            WHEN EXTRACT(HOUR FROM exit_time) BETWEEN 9 AND 11 THEN 'Morning'\n            WHEN EXTRACT(HOUR FROM exit_time) BETWEEN 12 AND 14 THEN 'Midday'\n            WHEN EXTRACT(HOUR FROM exit_time) BETWEEN 15 AND 18 THEN 'Evening Rush'\n            WHEN EXTRACT(HOUR FROM exit_time) BETWEEN 19 AND 21 THEN 'Evening'\n            ELSE 'Late Night'\n        END as exit_time_of_day,\n\n        -- Combined journey category\n        CONCAT(\n            CASE \n                WHEN EXTRACT(HOUR FROM entry_time) BETWEEN 0 AND 5 THEN 'Night'\n                WHEN EXTRACT(HOUR FROM entry_time) BETWEEN 6 AND 8 THEN 'Morning Rush'\n                WHEN EXTRACT(HOUR FROM entry_time) BETWEEN 9 AND 11 THEN 'Morning'\n                WHEN EXTRACT(HOUR FROM entry_time) BETWEEN 12 AND 14 THEN 'Midday'\n                WHEN EXTRACT(HOUR FROM entry_time) BETWEEN 15 AND 18 THEN 'Evening Rush'\n                WHEN EXTRACT(HOUR FROM entry_time) BETWEEN 19 AND 21 THEN 'Evening'\n                ELSE 'Late Night'\n            END,\n            ' to ',\n            CASE \n                WHEN EXTRACT(HOUR FROM exit_time) BETWEEN 0 AND 5 THEN 'Night'\n                WHEN EXTRACT(HOUR FROM exit_time) BETWEEN 6 AND 8 THEN 'Morning Rush'\n                WHEN EXTRACT(HOUR FROM exit_time) BETWEEN 9 AND 11 THEN 'Morning'\n                WHEN EXTRACT(HOUR FROM exit_time) BETWEEN 12 AND 14 THEN 'Midday'\n                WHEN EXTRACT(HOUR FROM exit_time) BETWEEN 15 AND 18 THEN 'Evening Rush'\n                WHEN EXTRACT(HOUR FROM exit_time) BETWEEN 19 AND 21 THEN 'Evening'\n                ELSE 'Late Night'\n            END\n        ) as journey_time_of_day,  -- e.g., \"Morning Rush to Midday\"\n\n        -- Hour-by-hour patterns (0-23) \n        EXTRACT(HOUR FROM entry_time) as entry_hour,\n        EXTRACT(HOUR FROM exit_time) as exit_hour,\n        \n        -- Duration categories\n        CASE \n            WHEN TIMESTAMP_DIFF(exit_time, entry_time, MINUTE) IS NULL THEN ''\n            WHEN TIMESTAMP_DIFF(exit_time, entry_time, MINUTE) < 5 THEN 'Very Short (<5 min)'\n            WHEN TIMESTAMP_DIFF(exit_time, entry_time, MINUTE) < 15 THEN 'Short (5-15 min)'\n            WHEN TIMESTAMP_DIFF(exit_time, entry_time, MINUTE) < 30 THEN 'Medium (15-30 min)'\n            WHEN TIMESTAMP_DIFF(exit_time, entry_time, MINUTE) < 60 THEN 'Long (30-60 min)'\n            ELSE 'Very Long (60+ min)'\n        END as travel_duration_category,\n\n        -- ============================================\n        -- VEHICLE & USAGE FEATURES\n        -- ============================================\n        \n        -- Vehicle class category\n        CASE \n            WHEN vehicle_type_code IN ('1', '2', '2L', '2H') THEN 'Passenger Vehicle'\n            WHEN vehicle_type_code IN ('3', '3L', '3H', 'B2', 'B3') THEN 'Light Commercial'\n            WHEN vehicle_type_code IN ('4', '5', '6', '7', '8', '9', '4L', '4H', '5H', '6H', '7H') THEN 'Heavy Commercial'\n            ELSE 'Unknown'\n        END as vehicle_class_category,\n        \n        -- Daily Number of Transactions by tag_plate_number\n        COUNT(*) OVER (PARTITION BY tag_plate_number, transaction_date) AS daily_count\n\n    FROM enriched\n)\n\nSELECT * FROM new_features\n) SELECT \n    -- Dates\n    transaction_date,\n    posting_date,\n    \n    -- Timestamps\n    entry_time,\n    exit_time,\n    \n    -- IDs\n    tag_plate_number,\n    agency,\n    agency_name,\n    description,\n    \n    -- Entry info\n    entry_plaza,\n    entry_plaza_name,\n    entry_lane,\n    \n    -- Exit info\n    exit_plaza,\n    exit_plaza_name,\n    exit_lane,\n    \n    -- Vehicle & fare\n    vehicle_type_code,\n    plan_rate,\n    fare_type,\n    \n    -- Financial\n    amount,\n    prepaid,\n    balance,\n    \n    -- New features\n    transaction_dayofweek,\n    transaction_dayofyear,\n    transaction_month,\n    transaction_day,\n    is_weekend,\n    entry_time_of_day,\n    exit_time_of_day,\n    journey_time_of_day,\n    entry_hour,\n    exit_hour,\n    travel_duration_category,\n    vehicle_class_category,\n\n    -- Metadata (last)\n    loaded_at as last_updated,\n    source_file\nFROM __dbt__cte___silver__feateng", "relation_name": "`njc-ezpass`.`ezpass_data`.`silver`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-05T05:52:09.983366Z", "completed_at": "2025-11-05T05:52:09.998392Z"}, {"name": "execute", "started_at": "2025-11-05T05:52:09.999133Z", "completed_at": "2025-11-05T05:52:09.999139Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.1031332015991211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ezpass_dbt.not_null_silver_amount.8bf3729051", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect amount\nfrom `njc-ezpass`.`ezpass_data`.`silver`\nwhere amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-05T05:52:09.962253Z", "completed_at": "2025-11-05T05:52:09.997976Z"}, {"name": "execute", "started_at": "2025-11-05T05:52:09.998731Z", "completed_at": "2025-11-05T05:52:09.998742Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.10492563247680664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ezpass_dbt.accepted_values_silver_agency__GSP__NJTP__SJ__PTC__DRJTBC__DRPA__PANYNJ__BCBC__NJ_E_ZPASS__CBDTP__DELDOT__DRBA__ILTOLL__ITRCC__MASSDOT__MDTA__META__MTAB_T__NHDOT__NYSBA__NYSTA__OTIC__VDOT.98b44ec0af", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        agency as value_field,\n        count(*) as n_records\n\n    from `njc-ezpass`.`ezpass_data`.`silver`\n    group by agency\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'GSP','NJTP','SJ','PTC','DRJTBC','DRPA','PANYNJ','BCBC','NJ E-ZPASS','CBDTP','DELDOT','DRBA','ILTOLL','ITRCC','MASSDOT','MDTA','META','MTAB&T','NHDOT','NYSBA','NYSTA','OTIC','VDOT'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-05T05:52:09.994051Z", "completed_at": "2025-11-05T05:52:10.000033Z"}, {"name": "execute", "started_at": "2025-11-05T05:52:10.000962Z", "completed_at": "2025-11-05T05:52:10.000968Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1677720546722412, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ezpass_dbt.not_null_silver_agency.fcb4312fae", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect agency\nfrom `njc-ezpass`.`ezpass_data`.`silver`\nwhere agency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-05T05:52:09.990815Z", "completed_at": "2025-11-05T05:52:09.999689Z"}, {"name": "execute", "started_at": "2025-11-05T05:52:10.000412Z", "completed_at": "2025-11-05T05:52:10.000427Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.17271137237548828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ezpass_dbt.not_null_silver_tag_plate_number.72514b1212", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tag_plate_number\nfrom `njc-ezpass`.`ezpass_data`.`silver`\nwhere tag_plate_number is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-05T05:52:10.129488Z", "completed_at": "2025-11-05T05:52:10.134802Z"}, {"name": "execute", "started_at": "2025-11-05T05:52:10.135174Z", "completed_at": "2025-11-05T05:52:10.135180Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07013154029846191, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ezpass_dbt.not_null_silver_transaction_date.2d43056018", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_date\nfrom `njc-ezpass`.`ezpass_data`.`silver`\nwhere transaction_date is null\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 2.865661144256592, "args": {"inject_ephemeral_ctes": true, "populate_cache": true, "profiles_dir": "C:\\Users\\Eric\\.dbt", "version_check": true, "log_path": "C:\\Users\\Eric\\Documents\\GitHub\\E-ZPass-Fraud-Detection\\ezpass_dbt\\logs", "require_batched_execution_for_custom_microbatch_strategy": false, "vars": {}, "show_resource_report": false, "log_file_max_bytes": 10485760, "defer": false, "use_colors_file": true, "send_anonymous_usage_stats": true, "source_freshness_run_project_hooks": true, "use_fast_test_edges": false, "show_all_deprecations": false, "require_yaml_configuration_for_mf_time_spines": false, "use_colors": true, "require_nested_cumulative_type_params": false, "static_parser": true, "empty": false, "indirect_selection": "eager", "write_json": true, "require_generic_test_arguments_property": true, "log_format_file": "debug", "state_modified_compare_more_unrendered_values": false, "strict_mode": false, "invocation_command": "dbt compile", "log_level": "info", "log_format": "default", "select": [], "require_resource_names_without_spaces": true, "printer_width": 80, "warn_error_options": {"error": [], "warn": [], "silence": []}, "introspect": true, "print": true, "log_level_file": "debug", "state_modified_compare_vars": false, "require_all_warnings_handled_by_warn_error": false, "validate_macro_args": false, "quiet": false, "partial_parse": true, "project_dir": "C:\\Users\\Eric\\Documents\\GitHub\\E-ZPass-Fraud-Detection\\ezpass_dbt", "partial_parse_file_diff": true, "output": "text", "macro_debugging": false, "cache_selected_only": false, "skip_nodes_if_on_run_start_fails": false, "upload_to_artifacts_ingest_api": false, "favor_state": false, "require_explicit_package_overrides_for_builtin_materializations": true, "which": "compile", "exclude": []}}